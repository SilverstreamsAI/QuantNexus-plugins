{
  "$schema": "https://quantnexus.io/schemas/plugin-manifest.json",
  "id": "com.quantnexus.backtest-engine",
  "name": "Backtest Engine",
  "version": "1.0.0",
  "description": "Python-based backtest engine with Backtrader integration",
  "type": "backtest",
  "category": "execution",
  "author": "QuantNexus Team",
  "license": "MIT",

  "main": "src/main.py",
  "executable": "python",
  "args": ["src/main.py", "--port", "50052"],
  "env": {
    "PYTHONUNBUFFERED": "1",
    "BACKTEST_LOG_LEVEL": "INFO"
  },

  "services": {
    "BacktestPlugin": {
      "port": 50052,
      "protocol": "grpc"
    }
  },

  "capabilities": [
    "streaming",
    "batch",
    "historical"
  ],

  "permissions": [
    "network:internal",
    "database",
    "filesystem"
  ],

  "dependencies": {
    "com.quantnexus.data": "^1.0.0"
  },

  "configSchema": {
    "type": "object",
    "properties": {
      "defaultInitialCapital": {
        "type": "number",
        "default": 100000,
        "description": "Default starting capital for backtests"
      },
      "defaultCommissionRate": {
        "type": "number",
        "default": 0.001,
        "description": "Default commission rate (0.001 = 0.1%)"
      },
      "defaultSlippageRate": {
        "type": "number",
        "default": 0.0005,
        "description": "Default slippage rate (0.0005 = 0.05%)"
      },
      "maxConcurrentBacktests": {
        "type": "integer",
        "default": 4,
        "description": "Maximum concurrent backtest tasks"
      },
      "checkpointEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Enable checkpoint/resume capability"
      },
      "checkpointIntervalBars": {
        "type": "integer",
        "default": 50,
        "description": "Save checkpoint every N bars"
      }
    }
  },

  "activationEvents": [
    "onCommand:backtest.*",
    "onStartup"
  ],

  "isolation": "trusted"
}
